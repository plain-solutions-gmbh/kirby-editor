var $i=Object.defineProperty;var Si=(p,P,T)=>P in p?$i(p,P,{enumerable:!0,configurable:!0,writable:!0,value:T}):p[P]=T;var w=(p,P,T)=>(Si(p,typeof P!="symbol"?P+"":P,T),T);(function(p){var me;"use strict";function P(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var T=P(p),ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-panel",{staticClass:"k-editor-view"},[n("main",{staticClass:"k-panel-main"},[n("k-panel-menu"),n("k-editor-header",{ref:"header",attrs:{current:e.current,"tree-open":e.treeOpen},on:{reload:function(r){return e.onFileChange(r)},discard:function(r){return e.$refs.preview.update(null)},download:function(r){return e.$refs.preview.download()},previewSelect:e.onPreviewSet,toggleTree:function(r){e.treeOpen=!e.treeOpen},save:function(r){return e.$refs.preview.save()}}}),n("div",{staticClass:"k-editor-main"},[n("div",{staticClass:"k-editor-tree",style:{width:(e.treeOpen?e.treeWidth:0)+"px"}},[n("k-filetree-field",{ref:"filetree",attrs:{height:"100%",required:!0,save:null,"read-path-from-url":!0},on:{input:function(r){return e.onSelect(r)},update:function(r){return e.onFiletreeUpdate(r)}}}),e.treeOpen?n("div",{staticClass:"resize-handle",on:{mousedown:e.startResizing}}):e._e()],1),n("k-editor-preview",{ref:"preview",attrs:{current:e.current},on:{hasChanges:function(r){e.$refs.header.hasChanges=r},select:function(r){return e.$refs.filetree.select(r)},update:function(r){e.current=r}}})],1)],1)])},gt=[],Ci="";function y(e,t,n,r,i,s,l,a){var o=typeof e=="function"?e.options:e;t&&(o.render=t,o.staticRenderFns=n,o._compiled=!0),r&&(o.functional=!0),s&&(o._scopeId="data-v-"+s);var c;if(l?(c=function(h){h=h||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!h&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(h=__VUE_SSR_CONTEXT__),i&&i.call(this,h),h&&h._registeredComponents&&h._registeredComponents.add(l)},o._ssrRegister=c):i&&(c=a?function(){i.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(o.functional){o._injectStyles=c;var u=o.render;o.render=function(g,f){return c.call(f),u(g,f)}}else{var d=o.beforeCreate;o.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:o}}const vt={data(){return{current:null,error:null,treeOpen:!0,treeWidth:200,resizing:!1}},mounted(){this.$panel.menu.close(),localStorage.getItem("plain.editor.notify.risk")!=="disabled"&&this.notify_risk(),window.addEventListener("popstate",this.onUrlUpdate)},beforeDestroy(){window.removeEventListener("popstate",this.onUrlUpdate)},methods:{updateParam(e,t){e!=null||(e=this.current.value);const n=new URL(window.location.href),r={path:e,...t&&{preview:t}};window.history.pushState({},"",n.pathname+"?"+this.$helper.url.buildQuery(r)+n.hash)},onUrlUpdate(){this.$refs.filetree.update(),this.$refs.preview.updatePreview(),this.$refs.header.updatePreview()},async onFiletreeUpdate(e){this.current=e!=null?e:await this.$api.get("plain/editor/get/toArray",{path:"/"})},onPreviewSet(e){e&&this.updateParam(null,e),this.$refs.preview.updatePreview(e)},onFileChange(e){this.$refs.filetree.init(e)},onSelect(e){this.error=null,e!==null&&(this.updateParam(e?e.value:"/"),this.current=e)},startResizing(e){this.resizing=!0,this.startX=e.clientX,this.startWidth=this.treeWidth,document.addEventListener("mousemove",this.resize),document.addEventListener("mouseup",this.stopResizing)},resize(e){var t;if(this.resizing){const i=e.clientX-this.startX;this.treeWidth=Math.min(500,Math.max(100,this.startWidth+i)),(t=this.$refs)!=null&&t.preview&&this.$refs.preview.$emit("resize")}},toggleTree(e){this.treeOpen=e},stopResizing(){this.resizing=!1,document.removeEventListener("mousemove",this.resize),document.removeEventListener("mouseup",this.stopResizing)},notify_risk(){window.panel.dialog.open({component:"k-editor-notify-risk",on:{submit:()=>{localStorage.setItem("plain.editor.notify.risk","disabled"),window.panel.dialog.close()},cancel:()=>{window.history.back()}}})}}},_e={};var mt=y(vt,ft,gt,!1,wt,null,null,null);function wt(e){for(let t in _e)this[t]=_e[t]}var kt=function(){return mt.exports}(),bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-header",{staticClass:"k-editor-header"},[n("k-button",{staticClass:"k-panel-menu-proxy",attrs:{icon:"bars"},on:{click:function(r){return e.$panel.menu.toggle()}}}),n("k-button",{attrs:{icon:e.treeOpen?"angle-left":"angle-right",title:e.treeOpen?e.$t("collapse"):e.$t("expand")},on:{click:function(r){return e.$emit("toggleTree")}}}),n("span",{staticClass:"k-editor-filename-wrapper"},[n("span",{staticClass:"k-editor-filename"},[e._v(e._s(e.title))])]),e.notification?n("k-button",{attrs:{slot:"buttons",icon:e.notification.icon,text:e.notification.message,theme:e.notification.theme,variant:"filled"},on:{click:function(r){return e.notification.close()}},slot:"buttons"}):n("k-button-group",{attrs:{slot:"buttons"},slot:"buttons"},[e._l(e.changeButtons,function(r){return n("k-button",e._b({key:r.text,attrs:{variant:"filled",size:"sm"}},"k-button",r,!1))}),e.allowPreviewSelector?n("k-button",{attrs:{variant:"filled",theme:"blue",size:"sm",text:e.$t(e.nextPreview+".label")},on:{click:e.toggleNextPreview}}):e._e(),n("k-button",{staticClass:"k-file-preview-frame-dropdown-toggle",attrs:{icon:"dots",size:"xs"},on:{click:function(r){return e.$refs.dropdown.toggle()}}}),n("k-dropdown-content",{ref:"dropdown"},[n("k-dropdown-item",{attrs:{icon:"file-add"},on:{click:function(r){return e.create("file")}}},[e._v(e._s(e.$t("plain.editor.file.new")))]),n("k-dropdown-item",{attrs:{icon:"folder-add"},on:{click:function(r){return e.create("folder")}}},[e._v(e._s(e.$t("plain.editor.folder.new")))]),e.current&&e.hasChanges===!1?n("hr"):e._e(),e.current&&e.hasChanges===!1?n("k-dropdown-item",{attrs:{icon:"title"},on:{click:function(r){return e.rename()}}},[e._v(e._s(e.$t("rename")))]):e._e(),e.current&&e.hasChanges===!1?n("k-dropdown-item",{attrs:{icon:"parent"},on:{click:function(r){return e.move()}}},[e._v(e._s(e.$t("move")))]):e._e(),e.current&&e.current.isFile&&e.hasChanges===!1?n("k-dropdown-item",{attrs:{icon:"download"},on:{click:function(r){return e.$emit("download")}}},[e._v(e._s(e.$t("download")))]):e._e(),e.current?n("hr"):e._e(),e.current?n("k-dropdown-item",{staticStyle:{"--button-color-text":"var(--color-negative)"},attrs:{icon:"trash"},on:{click:function(r){return e.remove()}}},[e._v(e._s(e.$t("delete")))]):e._e()],1)],2)],1)},_t=[],Pi="";const xt={props:{current:{type:Object,default:()=>null},treeOpen:{type:Boolean,default:()=>!1}},data(){return{previewComponents:[],previewNames:[],previewLabels:[],hasChanges:!1,previewIndex:0}},computed:{title(){var e,t;return this.$helper.string.ltrim((t=(e=this.current)==null?void 0:e.value)!=null?t:"","/")},allowPreviewSelector(){return this.previewComponents.length>1},notification(){return window.panel.notification.context==="view"&&!window.panel.notification.isFatal?window.panel.notification:null},nextPreview(){const e=(this.previewIndex+1)%this.previewNames.length;return this.previewNames[e]},changeButtons(){return this.hasChanges===!0?[{theme:"notice",text:this.$t("discard"),icon:"undo",responsive:!0,click:()=>this.$emit("discard")},{theme:"notice",text:this.$t("save"),icon:"check",click:()=>this.$emit("save")}]:[]}},watch:{current(e){var n;const t=(n=e==null?void 0:e.components)!=null?n:{};this.previewComponents=Object.keys(t),this.previewNames=Object.values(t),this.updatePreview()}},mounted(){window.addEventListener("keydown",this.saveHandler)},beforeUnmount(){window.removeEventListener("keydown",this.saveHandler)},methods:{toggleNextPreview(){this.previewIndex=(this.previewIndex+1)%this.previewNames.length,this.setPreview()},updatePreview(){const e=new URL(window.location.href).searchParams.get("preview");this.previewIndex=Math.max(this.previewNames.indexOf(e),0)},setPreview(){this.allowPreviewSelector?this.$emit("previewSelect",this.previewNames[this.previewIndex]):this.$emit("previewSelect",null)},async action(e,t={}){var n,r;this.$api.get(`plain/editor/get/${e}`,{path:(r=(n=this.current)==null?void 0:n.value)!=null?r:"",params:JSON.stringify(t)}).then(i=>{window.panel.dialog.close(),this.$emit("reload",i)}).catch(i=>{window.panel.notification.open({theme:"danger",timeout:3e4,message:i.message})})},create(e){window.panel.dialog.open({component:"k-form-dialog",props:{fields:{filename:{label:this.$t("name"),type:"text",allow:"a-z0-9@._-"}},submitButton:this.$t("create")},on:{submit:t=>{this.action("create",{name:t.filename,type:e})}}})},rename(){window.panel.dialog.open({component:"k-form-dialog",props:{fields:{filename:{label:this.$t("plain.editor.file.rename")+":",type:"text",allow:"a-z0-9@._-",after:"."+this.current.extension}},value:{filename:this.current.value},submitButton:this.$t("rename")},on:{submit:e=>{this.action("rename",{newName:e.filename})}}})},move(){window.panel.dialog.open({component:"k-form-dialog",props:{fields:{location:{type:"filetree",onlydir:!0,required:!1,height:"22rem"}},submitButton:this.$t("move")},on:{submit:e=>{const t=e.location?e.location+"/"+this.current.filename:null;this.action("move",{newRoot:t})}}})},remove(){window.panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("file.delete.confirm",{filename:this.current.filename})},on:{submit:()=>{this.action("remove")}}})},saveHandler(e){(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="s"&&this.hasChanges&&(e.preventDefault(),this.$emit("save"))}}},xe={};var yt=y(xt,bt,_t,!1,$t,null,null,null);function $t(e){for(let t in xe)this[t]=xe[t]}var St=function(){return yt.exports}(),Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview"},[e.error?n("div",{staticClass:"k-editor-preview-overlay"},[n("k-empty",{attrs:{icon:"cancel"}},[e._v(e._s(e.error))])],1):e._e(),e.loader?n("div",{staticClass:"k-editor-preview-overlay"},[n("k-icon",{attrs:{type:"loader"}}),typeof e.loader=="number"?n("k-progress",{attrs:{value:e.loader}}):e._e()],1):e._e(),e.component&&e.content!==null?n(e.component,{ref:"preview",tag:"component",attrs:{content:e.content,value:e.value,url:e.url,item:e.current,draft:e.draft},on:{select:function(r){return e.$emit("select",r)},update:function(r){return e.update(r)},error:function(r){e.error=r},onload:function(r){e.loader=r}}}):e._e()],1)},Pt=[],Oi="";const Ot={props:{current:{type:Object,default:()=>null}},data(){return{content:null,component:null,draft:null,modified:null,url:null,blob:null,error:null,db:null,loader:!1}},watch:{async current(e){await this.load(e),this.updatePreview()},draft(e){this.$emit("hasChanges",e!==null)},blob:{immediate:!0,handler(e){e?e.text().then(t=>{this.content=t,this.url=URL.createObjectURL(this.blob)}):this.content=null}}},created(){this.initDb()},methods:{async load(e){if(this.draft=this.content=this.modified=this.component=null,await this.getFromDb(e)){const t=await this.$api.get("plain/editor/get/modified",{path:e.value});this.modified<t.result&&(this.draft===null?await this.getFromServer():window.panel.notification.open({theme:"warning",icon:"alert",timeout:3e4,message:this.$t("plain.editor.notify.deprecated.text")}));return}await this.getFromServer()},updatePreview(e){var r,i,s;let t=(i=(r=this.current)==null?void 0:r.component)!=null?i:"k-editor-preview-default";const n=(s=this.current)==null?void 0:s.components;this.$helper.object.isObject(n)&&(e!=null||(e=new URL(window.location.href).searchParams.get("preview")),e!=null||(e=Object.values(n)[0]),t=Object.keys(n).find(l=>n[l]===e)),this.component=t},download(){const e=document.createElement("a");e.href=this.url,e.download=this.current.filename,document.body.appendChild(e),e.click()},update(e){this.draft=e===this.content?null:e,this.saveToDb()},save(e=!1){this.$api.post("plain/editor/save",{path:this.current.value,content:this.draft,modified:this.modified,force:e}).then(t=>{t.status==="outdated"?this.deprecatedVersion():(this.update(null),this.getFromServer())}).catch(t=>{window.panel.notification.open({theme:t.status,timeout:3e4,message:t.message})})},async getFromServer(){var i,s;this.loader=0,this.modified=null,this.draft=null;let e=0,t=[],n=null,r=!1;for(;!r;){const l=await this.$api.get("plain/editor/get/content",{path:this.current.value,params:JSON.stringify({index:e})});if(l.error){this.error=l.error,this.loader=!1;return}if(n!=null||(n=l.parts),(i=this.modified)!=null||(this.modified=l.modified),l.modified!==this.modified){t=[],e=0;continue}t.push(this.base64ToBytes(l.data)),r=l.eof,e++,this.loader=Math.round(e/n*100)}return this.blob=new Blob(t,{type:(s=this.current.mime)!=null?s:"application/octet-stream"}),this.saveToDb(),this.loader=!1,t},base64ToBytes(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},deprecatedVersion(){window.panel.dialog.open({component:"k-text-dialog",props:{text:this.$t("plain.editor.notify.deprecated.text"),submitButton:{icon:"undo",theme:"warning",text:this.$t("plain.editor.notify.deprecated.submit")}},on:{submit:()=>{window.panel.dialog.close(),this.save(!0)}}})},async initDb(){this.db=await new Promise((e,t)=>{const n=indexedDB.open("kirby-editor",1);n.onupgradeneeded=function(r){const i=r.target.result;i.objectStoreNames.contains("files")||i.createObjectStore("files")},n.onsuccess=r=>{e(r.target.result)},n.onerror=()=>t(null)})},getFromDb(e){return new Promise(t=>{const i=this.db.transaction("files","readonly").objectStore("files").get(e.value);i.onsuccess=s=>{const l=s.target.result;l?(this.blob=l.blob,this.draft=l.draft,this.modified=l.modified,t(!0)):t(!1)},i.onerror=()=>{t(!1)}})},saveToDb(){this.db.transaction("files","readwrite").objectStore("files").put({blob:this.blob,draft:this.draft,modified:this.modified},this.current.value)}}},ye={};var Rt=y(Ot,Ct,Pt,!1,Lt,null,null,null);function Lt(e){for(let t in ye)this[t]=ye[t]}var Tt=function(){return Rt.exports}(),Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-field",e._b({style:{height:e.height},attrs:{name:"filetree",type:"filetree"}},"k-field",e.$props,!1),[n("k-file-tree",{ref:"filetree",attrs:{onlydir:e.onlydir,current:e.value,"read-path-from-url":e.readPathFromUrl},on:{loaded:function(r){e.loading=!1},update:function(r){return e.$emit("update",r)},select:function(r){return e.input(r)}}}),e.loading?n("div",{staticClass:"k-tree-loader"},[n("k-icon",{attrs:{type:"loader"}})],1):e._e()],1)},jt=[],Ri="";const zt={extend:"k-field",props:{height:{type:String,default:"20rem"},onlydir:{type:Boolean,default:!1},required:{type:Boolean,default:()=>!1},value:{type:String,default:()=>null},save:{type:String,default:()=>"value"},readPathFromUrl:{type:Boolean,default:()=>!1}},data(){return{loading:!0}},methods:{init(e){this.$refs.filetree.init(e)},input(e){this.required===!1&&this.value===e.value&&(e=null),this.$emit("input",this.save?e==null?void 0:e[this.save]:e)},select(e){this.$refs.filetree.select(e)},update(e){this.$refs.filetree.update(e)}}},$e={};var Et=y(zt,Mt,jt,!1,Ht,null,null,null);function Ht(e){for(let t in $e)this[t]=$e[t]}var At=function(){return Et.exports}();const It={extends:"k-tree",inheritAttrs:!1,props:{onlydir:{type:Boolean,default:()=>!1},readPathFromUrl:{type:Boolean,default:()=>!1}},data(){return{state:[],item:null}},computed:{viewurl(){return this.$panel.view.url()},pathFromUrl(){return this.readPathFromUrl?new URL(window.location.href).searchParams.get("path")||"/":null}},mounted(){this.init()},methods:{async init(e){if(e&&(this.state=[],this.current=e.value),this.items)this.state=this.items;else{const t=await this.load(null);this.state=t,this.update(e==null?void 0:e.value),this.$emit("loaded")}},async load(e){var t;return await this.$api.get("plain/editor/tree",{path:e!=null?e:"",current:(t=this.current)!=null?t:this.pathFromUrl,onlydir:this.onlydir?1:0})},loadItem(e){var t;e.hasChildren&&Array.isArray(e.children)===!1&&this.load(e.children).then(n=>e.children=n),this.current=(t=e==null?void 0:e.value)!=null?t:null},update(e){this.readPathFromUrl&&(e!=null||(e=this.pathFromUrl)),e!=null||(e=this.current);const t=this.findItem(e);this.current=t==null?void 0:t.value,this.$emit("update",t)},select(e){var t;this.current=(t=e==null?void 0:e.value)!=null?t:null,this.$emit("select",e)},async open(e){if(!!e){if(e.hasChildren===!1)return!1;typeof e.children=="string"&&(this.$set(e,"loading",!0),e.children=await this.load(e.children),this.$set(e,"loading",!1)),this.$set(e,"open",!0)}},findItem(e,t){t!=null||(t=this.state),e!=null||(e=this.current);for(const n of t){if(n.value===e)return n;if(Array.isArray(n.children)&&n.children.length>0){const r=this.findItem(e,n.children);if(r)return r}}return null},isItem(e,t){return e.value===t}}};let Ft,Bt;const Se={};var Zt=y(It,Ft,Bt,!1,qt,null,null,null);function qt(e){for(let t in Se)this[t]=Se[t]}var Dt=function(){return Zt.exports}(),Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview-default"},[n("div",{staticClass:"k-editor-preview-default-preview"},[e.isLarge&&!e.content&&e.progress===!1?n("k-button",{attrs:{variant:"filled",icon:"preview"},on:{click:function(r){return e.loadFile()}}},[e._v("Load preview")]):e._e(),e.progress!==!1&&!e.content?n("k-progress",{attrs:{value:e.progress}}):e._e(),e.content?n("k-file-preview-frame",[e.type==="image"?n("img",{attrs:{src:e.url}}):e.type==="video"?n("video",{attrs:{src:e.url,preload:"metadata",controls:""}}):e.type==="audio"?n("audio",{attrs:{controls:"",preload:"metadata",src:e.url}}):n("k-icon",{attrs:{type:e.item.icon}})],1):e._e()],1),n("k-file-preview-details",{attrs:{details:e.details}})],1)},Nt=[],Li="";const Vt={props:{content:{type:String,default:()=>null},item:{type:Object,default:()=>null},url:{type:String,default:()=>null}},data(){return{progress:!1}},computed:{isLarge(){return this.item.size>5*1024*1024},details(){return[{title:this.$t("title"),text:this.item.filename},{title:this.$t("mime"),text:this.item.mime},{title:this.$t("plain.editor.modified"),text:this.item.modified},{title:this.$t("size"),text:this.item.niceSize}]},type(){var e;return(e=this.item.type)!=null?e:this.item.mime.split("/")[0]}},methods:{onLoad(e){this.progress=e},async loadFile(){await this.$options.mixins[0].methods.fetchFile.call(this)},async fetchFile(){this.isLarge||await this.$options.mixins[0].methods.fetchFile.call(this)}}},Ce={};var Wt=y(Vt,Ut,Nt,!1,Qt,null,null,null);function Qt(e){for(let t in Ce)this[t]=Ce[t]}var Gt=function(){return Wt.exports}(),Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview-folder"},[e.items.length>0?n("k-items",{attrs:{items:e.items,size:"small",layout:"cards"},on:{item:function(r){return e.select(r)}}}):n("div",{staticClass:"k-editor-preview-overlay"},[n("k-empty",{attrs:{icon:"cancel"}},[e._v(e._s(e.$t("plain.editor.folder.empty")))])],1)],1)},Kt=[],Ti="";const Jt={props:{content:{type:String,default:()=>null}},computed:{items(){return JSON.parse(this.content)}},methods:{select(e){this.$emit("select",e.value)}}},Pe={};var Yt=y(Jt,Xt,Kt,!1,en,null,null,null);function en(e){for(let t in Pe)this[t]=Pe[t]}var tn=function(){return Yt.exports}(),nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview-fonts"},[n("div",e._l(e.sizes,function(r){return n("p",{key:r,style:e.styleFor(r)},[e._v(" "+e._s(e.sampleText)+" ")])}),0)])},rn=[],Mi="";const sn={props:{url:{type:String,default:()=>null},family:{type:String,default:"CustomFont"},sampleText:{type:String,default:"The quick brown fox jumps over the lazy dog. 0123456789"},sizes:{type:Array,default:()=>[16,24,32,48,64]}},watch:{async url(e){try{const t=new FontFace(this.family,`url(${e})`);await t.load(),document.fonts.add(t)}catch(t){this.$emit("error","Font loading failed: "+t)}}},methods:{styleFor(e){return{fontFamily:`${this.family}, sans-serif`,fontSize:e+"px",lineHeight:1.3}}}},Oe={};var an=y(sn,nn,rn,!1,ln,null,null,null);function ln(e){for(let t in Oe)this[t]=Oe[t]}var on=function(){return an.exports}();function te(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var M=te();function Re(e){M=e}var E={exec:()=>null};function v(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(i,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(_.caret,"$1"),n=n.replace(i,l),r},getRegex:()=>new RegExp(n,t)};return r}var _={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},cn=/^(?:[ \t]*(?:\n|$))+/,un=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,hn=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,H=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,dn=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ne=/(?:[*+-]|\d{1,9}[.)])/,Le=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Te=v(Le).replace(/bull/g,ne).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),pn=v(Le).replace(/bull/g,ne).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),re=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,fn=/^[^\n]+/,ie=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,gn=v(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ie).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),vn=v(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ne).getRegex(),D="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",se=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,mn=v("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",se).replace("tag",D).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Me=v(re).replace("hr",H).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D).getRegex(),wn=v(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Me).getRegex(),ae={blockquote:wn,code:un,def:gn,fences:hn,heading:dn,hr:H,html:mn,lheading:Te,list:vn,newline:cn,paragraph:Me,table:E,text:fn},je=v("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",H).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D).getRegex(),kn={...ae,lheading:pn,table:je,paragraph:v(re).replace("hr",H).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",je).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D).getRegex()},bn={...ae,html:v(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",se).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:E,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:v(re).replace("hr",H).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Te).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},_n=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,xn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ze=/^( {2,}|\\)\n(?!\s*$)/,yn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,U=/[\p{P}\p{S}]/u,le=/[\s\p{P}\p{S}]/u,Ee=/[^\s\p{P}\p{S}]/u,$n=v(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,le).getRegex(),He=/(?!~)[\p{P}\p{S}]/u,Sn=/(?!~)[\s\p{P}\p{S}]/u,Cn=/(?:[^\s\p{P}\p{S}]|~)/u,Pn=/\[[^\[\]]*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Ae=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,On=v(Ae,"u").replace(/punct/g,U).getRegex(),Rn=v(Ae,"u").replace(/punct/g,He).getRegex(),Ie="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ln=v(Ie,"gu").replace(/notPunctSpace/g,Ee).replace(/punctSpace/g,le).replace(/punct/g,U).getRegex(),Tn=v(Ie,"gu").replace(/notPunctSpace/g,Cn).replace(/punctSpace/g,Sn).replace(/punct/g,He).getRegex(),Mn=v("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ee).replace(/punctSpace/g,le).replace(/punct/g,U).getRegex(),jn=v(/\\(punct)/,"gu").replace(/punct/g,U).getRegex(),zn=v(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),En=v(se).replace("(?:-->|$)","-->").getRegex(),Hn=v("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",En).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),N=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`[^`]*`|[^\[\]\\`])*?/,An=v(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",N).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Fe=v(/^!?\[(label)\]\[(ref)\]/).replace("label",N).replace("ref",ie).getRegex(),Be=v(/^!?\[(ref)\](?:\[\])?/).replace("ref",ie).getRegex(),In=v("reflink|nolink(?!\\()","g").replace("reflink",Fe).replace("nolink",Be).getRegex(),oe={_backpedal:E,anyPunctuation:jn,autolink:zn,blockSkip:Pn,br:ze,code:xn,del:E,emStrongLDelim:On,emStrongRDelimAst:Ln,emStrongRDelimUnd:Mn,escape:_n,link:An,nolink:Be,punctuation:$n,reflink:Fe,reflinkSearch:In,tag:Hn,text:yn,url:E},Fn={...oe,link:v(/^!?\[(label)\]\((.*?)\)/).replace("label",N).getRegex(),reflink:v(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",N).getRegex()},ce={...oe,emStrongRDelimAst:Tn,emStrongLDelim:Rn,url:v(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Bn={...ce,br:v(ze).replace("{2,}","*").getRegex(),text:v(ce.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},V={normal:ae,gfm:kn,pedantic:bn},A={normal:oe,gfm:ce,breaks:Bn,pedantic:Fn},Zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ze=e=>Zn[e];function S(e,t){if(t){if(_.escapeTest.test(e))return e.replace(_.escapeReplace,Ze)}else if(_.escapeTestNoEncode.test(e))return e.replace(_.escapeReplaceNoEncode,Ze);return e}function qe(e){try{e=encodeURI(e).replace(_.percentDecode,"%")}catch{return null}return e}function De(e,t){var s;let n=e.replace(_.findPipe,(l,a,o)=>{let c=!1,u=a;for(;--u>=0&&o[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(_.splitPipe),i=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(_.slashPipe,"|");return r}function I(e,t,n){let r=e.length;if(r===0)return"";let i=0;for(;i<r;){let s=e.charAt(r-i-1);if(s===t&&!n)i++;else if(s!==t&&n)i++;else break}return e.slice(0,r-i)}function qn(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Ue(e,t,n,r,i){let s=t.href,l=t.title||null,a=e[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;let o={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:l,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,o}function Dn(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let i=r[1];return t.split(`
`).map(s=>{let l=s.match(n.other.beginningSpace);if(l===null)return s;let[a]=l;return a.length>=i.length?s.slice(i.length):s}).join(`
`)}var W=class{constructor(e){w(this,"options");w(this,"rules");w(this,"lexer");this.options=e||M}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:I(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=Dn(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=I(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:I(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=I(t[0],`
`).split(`
`),r="",i="",s=[];for(;n.length>0;){let l=!1,a=[],o;for(o=0;o<n.length;o++)if(this.rules.other.blockquoteStart.test(n[o]))a.push(n[o]),l=!0;else if(!l)a.push(n[o]);else break;n=n.slice(o);let c=a.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=d,n.length===0)break;let h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){let g=h,f=g.raw+`
`+n.join(`
`),k=this.blockquote(f);s[s.length-1]=k,r=r.substring(0,r.length-g.raw.length)+k.raw,i=i.substring(0,i.length-g.text.length)+k.text;break}else if((h==null?void 0:h.type)==="list"){let g=h,f=g.raw+`
`+n.join(`
`),k=this.list(f);s[s.length-1]=k,r=r.substring(0,r.length-h.raw.length)+k.raw,i=i.substring(0,i.length-g.raw.length)+k.raw,n=f.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let s=this.rules.other.listItemRegex(n),l=!1;for(;e;){let o=!1,c="",u="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,$=>" ".repeat(3*$.length)),h=e.split(`
`,1)[0],g=!d.trim(),f=0;if(this.options.pedantic?(f=2,u=d.trimStart()):g?f=t[1].length+1:(f=t[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,u=d.slice(f),f+=t[1].length),g&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),o=!0),!o){let $=this.rules.other.nextBulletRegex(f),b=this.rules.other.hrRegex(f),C=this.rules.other.fencesBeginRegex(f),ee=this.rules.other.headingBeginRegex(f),yi=this.rules.other.htmlBeginRegex(f);for(;e;){let we=e.split(`
`,1)[0],q;if(h=we,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),q=h):q=h.replace(this.rules.other.tabCharGlobal,"    "),C.test(h)||ee.test(h)||yi.test(h)||$.test(h)||b.test(h))break;if(q.search(this.rules.other.nonSpaceChar)>=f||!h.trim())u+=`
`+q.slice(f);else{if(g||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||C.test(d)||ee.test(d)||b.test(d))break;u+=`
`+h}!g&&!h.trim()&&(g=!0),c+=we+`
`,e=e.substring(we.length+1),d=q.slice(f)}}i.loose||(l?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(l=!0));let k=null,x;this.options.gfm&&(k=this.rules.other.listIsTask.exec(u),k&&(x=k[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!k,checked:x,loose:!1,text:u,tokens:[]}),i.raw+=c}let a=i.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let o=0;o<i.items.length;o++)if(this.lexer.state.top=!1,i.items[o].tokens=this.lexer.blockTokens(i.items[o].text,[]),!i.loose){let c=i.items[o].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));i.loose=u}if(i.loose)for(let o=0;o<i.items.length;o++)i.items[o].loose=!0;return i}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:i}}}table(e){var l;let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=De(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(l=t[3])!=null&&l.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let a of r)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(let a of i)s.rows.push(De(a,s.header.length).map((o,c)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[c]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=I(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=qn(t[2],"()");if(s===-2)return;if(s>-1){let l=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let r=t[2],i="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Ue(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[r.toLowerCase()];if(!i){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Ue(n,i,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let i=[...r[0]].length-1,s,l,a=i,o=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+i);(r=c.exec(t))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(l=[...s].length,r[3]||r[4]){a+=l;continue}else if((r[5]||r[6])&&i%3&&!((i+l)%3)){o+=l;continue}if(a-=l,a>0)continue;l=Math.min(l,l+a+o);let u=[...r[0]][0].length,d=e.slice(0,i+r.index+u+l);if(Math.min(i,l)%2){let g=d.slice(1,-1);return{type:"em",raw:d,text:g,tokens:this.lexer.inlineTokens(g)}}let h=d.slice(2,-2);return{type:"strong",raw:d,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),i=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&i&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n,r;let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=t[0],s="mailto:"+i;else{let l;do l=t[0],t[0]=(r=(n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])!=null?r:"";while(l!==t[0]);i=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},O=class ke{constructor(t){w(this,"tokens");w(this,"options");w(this,"state");w(this,"tokenizer");w(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||M,this.options.tokenizer=this.options.tokenizer||new W,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:_,block:V.normal,inline:A.normal};this.options.pedantic?(n.block=V.pedantic,n.inline=A.pedantic):this.options.gfm&&(n.block=V.gfm,this.options.breaks?n.inline=A.breaks:n.inline=A.gfm),this.tokenizer.rules=n}static get rules(){return{block:V,inline:A}}static lex(t,n){return new ke(n).lex(t)}static lexInline(t,n){return new ke(n).inlineTokens(t)}lex(t){t=t.replace(_.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var i,s,l;for(this.options.pedantic&&(t=t.replace(_.tabCharGlobal,"    ").replace(_.spaceLine,""));t;){let a;if((s=(i=this.options.extensions)==null?void 0:i.block)!=null&&s.some(c=>(a=c.call({lexer:this},t,n))?(t=t.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);let c=n.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);let c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);let c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},n.push(a));continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),n.push(a);continue}let o=t;if((l=this.options.extensions)!=null&&l.startBlock){let c=1/0,u=t.slice(1),d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(o=t.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(o))){let c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a),r=o.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);let c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var a,o,c;let r=t,i=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,l="";for(;t;){s||(l=""),s=!1;let u;if((o=(a=this.options.extensions)==null?void 0:a.inline)!=null&&o.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);let h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,l)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0,g=t.slice(1),f;this.options.extensions.startInline.forEach(k=>{f=k.call({lexer:this},g),typeof f=="number"&&f>=0&&(h=Math.min(h,f))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(l=u.raw.slice(-1)),s=!0;let h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){let h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},Q=class{constructor(e){w(this,"options");w(this,"parser");this.options=e||M}space(e){return""}code({text:e,lang:t,escaped:n}){var s;let r=(s=(t||"").match(_.notSpaceStart))==null?void 0:s[0],i=e.replace(_.endingNewline,"")+`
`;return r?'<pre><code class="language-'+S(r)+'">'+(n?i:S(i,!0))+`</code></pre>
`:"<pre><code>"+(n?i:S(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let l=0;l<e.items.length;l++){let a=e.items[l];r+=this.listitem(a)}let i=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+i+s+`>
`+r+"</"+i+`>
`}listitem(e){var n;let t="";if(e.task){let r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+S(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let i=0;i<e.header.length;i++)n+=this.tablecell(e.header[i]);t+=this.tablerow({text:n});let r="";for(let i=0;i<e.rows.length;i++){let s=e.rows[i];n="";for(let l=0;l<s.length;l++)n+=this.tablecell(s[l]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${S(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),i=qe(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+S(t)+'"'),s+=">"+r+"</a>",s}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let i=qe(e);if(i===null)return S(n);e=i;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${S(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:S(e.text)}},ue=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},R=class be{constructor(t){w(this,"options");w(this,"renderer");w(this,"textRenderer");this.options=t||M,this.options.renderer=this.options.renderer||new Q,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ue}static parse(t,n){return new be(n).parse(t)}static parseInline(t,n){return new be(n).parseInline(t)}parse(t,n=!0){var i,s;let r="";for(let l=0;l<t.length;l++){let a=t[l];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[a.type]){let c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){r+=u||"";continue}}let o=a;switch(o.type){case"space":{r+=this.renderer.space(o);continue}case"hr":{r+=this.renderer.hr(o);continue}case"heading":{r+=this.renderer.heading(o);continue}case"code":{r+=this.renderer.code(o);continue}case"table":{r+=this.renderer.table(o);continue}case"blockquote":{r+=this.renderer.blockquote(o);continue}case"list":{r+=this.renderer.list(o);continue}case"html":{r+=this.renderer.html(o);continue}case"def":{r+=this.renderer.def(o);continue}case"paragraph":{r+=this.renderer.paragraph(o);continue}case"text":{let c=o,u=this.renderer.text(c);for(;l+1<t.length&&t[l+1].type==="text";)c=t[++l],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{let c='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var i,s;let r="";for(let l=0;l<t.length;l++){let a=t[l];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[a.type]){let c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}let o=a;switch(o.type){case"escape":{r+=n.text(o);break}case"html":{r+=n.html(o);break}case"link":{r+=n.link(o);break}case"image":{r+=n.image(o);break}case"strong":{r+=n.strong(o);break}case"em":{r+=n.em(o);break}case"codespan":{r+=n.codespan(o);break}case"br":{r+=n.br(o);break}case"del":{r+=n.del(o);break}case"text":{r+=n.text(o);break}default:{let c='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},G=(me=class{constructor(e){w(this,"options");w(this,"block");this.options=e||M}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?O.lex:O.lexInline}provideParser(){return this.block?R.parse:R.parseInline}},w(me,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),me),Un=class{constructor(...e){w(this,"defaults",te());w(this,"options",this.setOptions);w(this,"parse",this.parseMarkdown(!0));w(this,"parseInline",this.parseMarkdown(!1));w(this,"Parser",R);w(this,"Renderer",Q);w(this,"TextRenderer",ue);w(this,"Lexer",O);w(this,"Tokenizer",W);w(this,"Hooks",G);this.use(...e)}walkTokens(e,t){var r,i;let n=[];for(let s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{let l=s;for(let a of l.header)n=n.concat(this.walkTokens(a.tokens,t));for(let a of l.rows)for(let o of a)n=n.concat(this.walkTokens(o.tokens,t));break}case"list":{let l=s;n=n.concat(this.walkTokens(l.items,t));break}default:{let l=s;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[l.type]?this.defaults.extensions.childTokens[l.type].forEach(a=>{let o=l[a].flat(1/0);n=n.concat(this.walkTokens(o,t))}):l.tokens&&(n=n.concat(this.walkTokens(l.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=t.renderers[i.name];s?t.renderers[i.name]=function(...l){let a=i.renderer.apply(this,l);return a===!1&&(a=s.apply(this,l)),a}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=t[i.level];s?s.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),r.extensions=t),n.renderer){let i=this.defaults.renderer||new Q(this.defaults);for(let s in n.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let l=s,a=n.renderer[l],o=i[l];i[l]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=o.apply(i,c)),u||""}}r.renderer=i}if(n.tokenizer){let i=this.defaults.tokenizer||new W(this.defaults);for(let s in n.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let l=s,a=n.tokenizer[l],o=i[l];i[l]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=o.apply(i,c)),u}}r.tokenizer=i}if(n.hooks){let i=this.defaults.hooks||new G;for(let s in n.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let l=s,a=n.hooks[l],o=i[l];G.passThroughHooks.has(s)?i[l]=c=>{if(this.defaults.async)return Promise.resolve(a.call(i,c)).then(d=>o.call(i,d));let u=a.call(i,c);return o.call(i,u)}:i[l]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=o.apply(i,c)),u}}r.hooks=i}if(n.walkTokens){let i=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(l){let a=[];return a.push(s.call(this,l)),i&&(a=a.concat(i.call(this,l))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return O.lex(e,t!=null?t:this.defaults)}parser(e,t){return R.parse(e,t!=null?t:this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},i={...this.defaults,...r},s=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&r.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);let l=i.hooks?i.hooks.provideLexer():e?O.lex:O.lexInline,a=i.hooks?i.hooks.provideParser():e?R.parse:R.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(o=>l(o,i)).then(o=>i.hooks?i.hooks.processAllTokens(o):o).then(o=>i.walkTokens?Promise.all(this.walkTokens(o,i.walkTokens)).then(()=>o):o).then(o=>a(o,i)).then(o=>i.hooks?i.hooks.postprocess(o):o).catch(s);try{i.hooks&&(t=i.hooks.preprocess(t));let o=l(t,i);i.hooks&&(o=i.hooks.processAllTokens(o)),i.walkTokens&&this.walkTokens(o,i.walkTokens);let c=a(o,i);return i.hooks&&(c=i.hooks.postprocess(c)),c}catch(o){return s(o)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+S(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},j=new Un;function m(e,t){return j.parse(e,t)}m.options=m.setOptions=function(e){return j.setOptions(e),m.defaults=j.defaults,Re(m.defaults),m},m.getDefaults=te,m.defaults=M,m.use=function(...e){return j.use(...e),m.defaults=j.defaults,Re(m.defaults),m},m.walkTokens=function(e,t){return j.walkTokens(e,t)},m.parseInline=j.parseInline,m.Parser=R,m.parser=R.parse,m.Renderer=Q,m.TextRenderer=ue,m.Lexer=O,m.lexer=O.lex,m.Tokenizer=W,m.Hooks=G,m.parse=m,m.options,m.setOptions,m.use,m.walkTokens,m.parseInline,R.parse,O.lex;var Nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview-markdown",attrs:{name:"markdown",theme:e.theme},domProps:{innerHTML:e._s(e.compiled)}})},Vn=[],ji="";const Wn={props:{content:{type:String,default:()=>null},draft:{type:String,default:()=>null}},computed:{compiled(){var e;return m.parse((e=this.draft)!=null?e:this.content)},theme(){var e,t;return(t=(e=this.$panel.theme)==null?void 0:e.current)!=null?t:""}}},Ne={};var Qn=y(Wn,Nn,Vn,!1,Gn,null,null,null);function Gn(e){for(let t in Ne)this[t]=Ne[t]}var Xn=function(){return Qn.exports}(),Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"k-editor-preview-object"},[n("iframe",{attrs:{src:e.url}})])},Jn=[],zi="";const Yn={props:{url:{type:String,default:()=>null}}},Ve={};var er=y(Yn,Kn,Jn,!1,tr,null,null,null);function tr(e){for(let t in Ve)this[t]=Ve[t]}var nr=function(){return er.exports}();function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?We(Object(n),!0).forEach(function(r){rr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ir(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function sr(e,t){if(e==null)return{};var n=ir(e,t),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(n[r]=e[r]))}return n}function ar(e,t){return lr(e)||or(e,t)||cr(e,t)||ur()}function lr(e){if(Array.isArray(e))return e}function or(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,i=!1,s=void 0;try{for(var l=e[Symbol.iterator](),a;!(r=(a=l.next()).done)&&(n.push(a.value),!(t&&n.length===t));r=!0);}catch(o){i=!0,s=o}finally{try{!r&&l.return!=null&&l.return()}finally{if(i)throw s}}return n}}function cr(e,t){if(!!e){if(typeof e=="string")return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}}function Ge(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ur(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xe(Object(n),!0).forEach(function(r){hr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(i,s){return s(i)},r)}}function F(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var l=arguments.length,a=new Array(l),o=0;o<l;o++)a[o]=arguments[o];return t.apply(n,[].concat(i,a))}}}function X(e){return{}.toString.call(e).includes("Object")}function pr(e){return!Object.keys(e).length}function B(e){return typeof e=="function"}function fr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function gr(e,t){return X(t)||L("changeType"),Object.keys(t).some(function(n){return!fr(e,n)})&&L("changeField"),t}function vr(e){B(e)||L("selectorType")}function mr(e){B(e)||X(e)||L("handlerType"),X(e)&&Object.values(e).some(function(t){return!B(t)})&&L("handlersType")}function wr(e){e||L("initialIsRequired"),X(e)||L("initialType"),pr(e)&&L("initialContent")}function kr(e,t){throw new Error(e[t]||e.default)}var br={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},L=F(kr)(br),K={changes:gr,selector:vr,handler:mr,initial:wr};function _r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};K.initial(e),K.handler(t);var n={current:e},r=F($r)(n,t),i=F(yr)(n),s=F(K.changes)(e),l=F(xr)(n);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return K.selector(c),c(n.current)}function o(c){dr(r,i,s,l)(c)}return[a,o]}function xr(e,t){return B(t)?t(e.current):t}function yr(e,t){return e.current=Ke(Ke({},e.current),t),t}function $r(e,t,n){return B(t)?t(e.current):Object.keys(n).forEach(function(r){var i;return(i=t[r])===null||i===void 0?void 0:i.call(t,e.current[r])}),n}var Sr={create:_r},Cr={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function Pr(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var l=arguments.length,a=new Array(l),o=0;o<l;o++)a[o]=arguments[o];return t.apply(n,[].concat(i,a))}}}function Or(e){return{}.toString.call(e).includes("Object")}function Rr(e){return e||Ye("configIsRequired"),Or(e)||Ye("configType"),e.urls?(Lr(),{paths:{vs:e.urls.monacoBase}}):e}function Lr(){console.warn(Je.deprecation)}function Tr(e,t){throw new Error(e[t]||e.default)}var Je={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Ye=Pr(Tr)(Je),Mr={config:Rr},jr=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,l){return l(s)},i)}};function et(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],et(e[n],t[n]))}),Qe(Qe({},e),t)}var zr={type:"cancelation",msg:"operation is manually canceled"};function he(e){var t=!1,n=new Promise(function(r,i){e.then(function(s){return t?i(zr):r(s)}),e.catch(i)});return n.cancel=function(){return t=!0},n}var Er=Sr.create({config:Cr,isInitialized:!1,resolve:null,reject:null,monaco:null}),tt=ar(Er,2),Z=tt[0],J=tt[1];function Hr(e){var t=Mr.config(e),n=t.monaco,r=sr(t,["monaco"]);J(function(i){return{config:et(i.config,r),monaco:n}})}function Ar(){var e=Z(function(t){var n=t.monaco,r=t.isInitialized,i=t.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!e.isInitialized){if(J({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),he(de);if(window.monaco&&window.monaco.editor)return nt(window.monaco),e.resolve(window.monaco),he(de);jr(Ir,Br)(Zr)}return he(de)}function Ir(e){return document.body.appendChild(e)}function Fr(e){var t=document.createElement("script");return e&&(t.src=e),t}function Br(e){var t=Z(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=Fr("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Zr(){var e=Z(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){nt(n),e.resolve(n)},function(n){e.reject(n)})}function nt(e){Z().monaco||J({monaco:e})}function qr(){return Z(function(e){var t=e.monaco;return t})}var de=new Promise(function(e,t){return J({resolve:e,reject:t})}),pe={config:Hr,init:Ar,__getMonacoInstance:qr};T.default.util.warn;var Dr=Object.defineProperty,Ur=Object.defineProperties,Nr=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertySymbols,Vr=Object.prototype.hasOwnProperty,Wr=Object.prototype.propertyIsEnumerable,it=(e,t,n)=>t in e?Dr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fe=(e,t)=>{for(var n in t||(t={}))Vr.call(t,n)&&it(e,n,t[n]);if(rt)for(var n of rt(t))Wr.call(t,n)&&it(e,n,t[n]);return e},Qr=(e,t)=>Ur(e,Nr(t));const ge={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function st(e,t){const n=p.computed(()=>{const{width:i,height:s}=e;return Qr(fe({},ge.wrapper),{width:i,height:s})}),r=p.computed(()=>fe(fe({},ge.fullWidth),!t.value&&ge.hide));return{wrapperStyle:n,containerStyle:r}}function at(){const e=p.shallowRef(pe.__getMonacoInstance()),t=p.ref(!1);let n;return p.onMounted(()=>{e.value||(n=pe.init(),n.then(i=>e.value=i).catch(i=>{(i==null?void 0:i.type)!=="cancelation"&&(t.value=!0,console.error("Monaco initialization error:",i))}))}),{monacoRef:e,unload:()=>n==null?void 0:n.cancel(),isLoadFailed:t}}function Y(e){return typeof e=="function"?e():e}function ve(e){return e===void 0}function z(e,t,n,r){return Gr(e,r)||Xr(e,t,n,r)}function Gr(e,t){return e.editor.getModel(lt(e,t))}function Xr(e,t,n,r){return e.editor.createModel(t,n,r?lt(e,r):void 0)}function lt(e,t){return e.Uri.parse(t)}var Kr=Object.defineProperty,ot=Object.getOwnPropertySymbols,Jr=Object.prototype.hasOwnProperty,Yr=Object.prototype.propertyIsEnumerable,ct=(e,t,n)=>t in e?Kr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ei=(e,t)=>{for(var n in t||(t={}))Jr.call(t,n)&&ct(e,n,t[n]);if(ot)for(var n of ot(t))Yr.call(t,n)&&ct(e,n,t[n]);return e};const ti={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var ni=p.defineComponent({name:"VueMonacoEditor",model:{prop:"value",event:"update:value"},props:{defaultValue:String,defaultPath:String,defaultLanguage:String,value:String,language:String,path:String,theme:{type:String,default:"vs"},line:Number,options:{type:Object,default:()=>({})},overrideServices:{type:Object,default:()=>({})},saveViewState:{type:Boolean,default:!0},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String},emits:["update:value","beforeMount","mount","change","validate"],setup(e,t){const n=new Map,r=p.shallowRef(null),{monacoRef:i,unload:s,isLoadFailed:l}=at(),{editorRef:a}=ri(t,e,i,r),{disposeValidator:o}=ii(t,e,i,a),c=p.computed(()=>!!i.value&&!!a.value),{wrapperStyle:u,containerStyle:d}=st(e,c);return p.onUnmounted(()=>{var h,g;(h=o.value)==null||h.call(o),a.value?((g=a.value.getModel())==null||g.dispose(),a.value.dispose()):s()}),p.watch([()=>e.path,()=>e.value,()=>e.language,()=>e.line],([h,g,f,k],[x,$,b,C])=>{if(!!c.value){if(h!==x){const ee=z(i.value,g||e.defaultValue||"",f||e.defaultLanguage||"",h||e.defaultPath||"");e.saveViewState&&n.set(x,a.value.saveViewState()),a.value.setModel(ee),e.saveViewState&&a.value.restoreViewState(n.get(h)),ve(k)||a.value.revealLine(k);return}a.value.getValue()!==g&&a.value.setValue(g),f!==b&&i.value.editor.setModelLanguage(a.value.getModel(),f),!ve(k)&&k!==C&&a.value.revealLine(k)}}),p.watch(()=>e.options,h=>a.value&&a.value.updateOptions(h),{deep:!0}),p.watch(()=>e.theme,h=>i.value&&i.value.editor.setTheme(h)),{containerRef:r,isEditorReady:c,isLoadFailed:l,wrapperStyle:u,containerStyle:d}},render(){const{$slots:e,isEditorReady:t,isLoadFailed:n,wrapperStyle:r,containerStyle:i,className:s}=this;return p.h("div",{style:r},[!t&&p.h("div",{style:ti},n?e.failure?Y(e.failure):"load failed":e.default?Y(e.default):"loading..."),p.h("div",{ref:"containerRef",key:"monaco_editor_container",style:i,class:s})])}});function ri({emit:e},t,n,r){const i=p.shallowRef(null);p.onMounted(()=>{const l=p.watch(n,()=>{r.value&&n.value&&(p.nextTick(()=>l()),s())},{immediate:!0})});function s(){var l;if(!r.value||!n.value||i.value)return;e("beforeMount",n.value);const a=t.path||t.defaultPath,o=z(n.value,t.value||t.defaultValue||"",t.language||t.defaultLanguage||"",a||"");i.value=n.value.editor.create(r.value,ei({model:o,theme:t.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0},t.options),t.overrideServices),(l=i.value)==null||l.onDidChangeModelContent(c=>{const u=i.value.getValue();u!==t.value&&(e("update:value",u),e("change",u,c))}),i.value&&!ve(t.line)&&i.value.revealLine(t.line),e("mount",i.value,n.value)}return{editorRef:i}}function ii({emit:e},t,n,r){const i=p.ref(null),s=p.watch([n,r],()=>{if(n.value&&r.value){p.nextTick(()=>s());const l=n.value.editor.onDidChangeMarkers(a=>{var o,c;const u=(c=(o=r.value)==null?void 0:o.getModel())==null?void 0:c.uri;if(u&&a.find(h=>h.path===u.path)){const h=n.value.editor.getModelMarkers({resource:u});e("validate",h)}});i.value=()=>l==null?void 0:l.dispose()}});return{disposeValidator:i}}var si=Object.defineProperty,ut=Object.getOwnPropertySymbols,ai=Object.prototype.hasOwnProperty,li=Object.prototype.propertyIsEnumerable,ht=(e,t,n)=>t in e?si(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oi=(e,t)=>{for(var n in t||(t={}))ai.call(t,n)&&ht(e,n,t[n]);if(ut)for(var n of ut(t))li.call(t,n)&&ht(e,n,t[n]);return e};const ci={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};p.defineComponent({name:"VueMonacoDiffEditor",props:{original:String,modified:String,language:String,originalLanguage:String,modifiedLanguage:String,originalModelPath:String,modifiedModelPath:String,theme:{type:String,default:"vs"},options:{type:Object,default:()=>({})},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String},setup(e,t){const n=p.shallowRef(null),{monacoRef:r,unload:i,isLoadFailed:s}=at(),{diffEditorRef:l}=ui(t,e,r,n),a=p.computed(()=>!!r.value&&!!l.value),{wrapperStyle:o,containerStyle:c}=st(e,a);return p.onUnmounted(()=>{var u,d,h,g,f,k,x,$;!r.value&&i();const b=(d=(u=l.value)==null?void 0:u.getModel)==null?void 0:d.call(u);(g=(h=b==null?void 0:b.original)==null?void 0:h.dispose)==null||g.call(h),(k=(f=b==null?void 0:b.modified)==null?void 0:f.dispose)==null||k.call(f),($=(x=l.value)==null?void 0:x.dispose)==null||$.call(x)}),p.watch([()=>e.originalModelPath,()=>e.original,()=>e.originalLanguage,()=>e.language],([u,d,h,g],[f,k,x,$])=>{if(!a.value)return;const b=l.value.getOriginalEditor();if(u!==f){const C=z(r.value,d||"",h||g||"text",u||"");b.setModel(C);return}d!==b.getValue()&&b.setValue(d||""),(h!==x||g!==$)&&r.value.editor.setModelLanguage(l.value.getModel().original,h||g||"text")}),p.watch([()=>e.modifiedModelPath,()=>e.modified,()=>e.modifiedLanguage,()=>e.language],([u,d,h,g],[f,k,x,$])=>{if(!a.value)return;const b=l.value.getModifiedEditor();if(f!==u){const C=z(r.value,d||"",h||g||"text",u||"");b.setModel(C);return}if(d!==b.getValue()){const C=r.value.editor.EditorOption.readOnly;b.getOption(C)?b.setValue(d||""):(b.executeEdits("",[{range:b.getModel().getFullModelRange(),text:d||"",forceMoveMarkers:!0}]),b.pushUndoStop())}(h!==x||g!==$)&&r.value.editor.setModelLanguage(l.value.getModel().modified,h||g||"text")}),p.watch(()=>e.theme,()=>{var u;return(u=r.value)==null?void 0:u.editor.setTheme(e.theme)}),p.watch(()=>e.options,()=>{var u;return(u=l.value)==null?void 0:u.updateOptions(e.options)},{deep:!0}),{containerRef:n,isDiffEditorReady:a,isLoadFailed:s,wrapperStyle:o,containerStyle:c}},render(){const{$slots:e,isDiffEditorReady:t,isLoadFailed:n,wrapperStyle:r,containerStyle:i,className:s}=this;return p.h("div",{style:r},[!t&&p.h("div",{style:ci},n?e.failure?Y(e.failure):"load failed":e.default?Y(e.default):"loading..."),p.h("div",{ref:"containerRef",key:"monaco_diff_editor_container",style:i,class:s})])}});function ui({emit:e},t,n,r){const i=p.shallowRef(null);p.onMounted(()=>{const l=p.watch(n,()=>{r.value&&n.value&&(p.nextTick(()=>l()),s())},{immediate:!0})});function s(){var l;if(!r.value||!n.value||i.value)return;e("beforeMount",n.value),i.value=n.value.editor.createDiffEditor(r.value,oi({automaticLayout:!0,autoIndent:"brackets",theme:t.theme,formatOnPaste:!0,formatOnType:!0},t.options));const a=z(n.value,t.original||"",t.originalLanguage||t.language||"text",t.originalModelPath||""),o=z(n.value,t.modified||"",t.modifiedLanguage||t.language||"text",t.modifiedModelPath||"");(l=i.value)==null||l.setModel({original:a,modified:o}),e("mount",i.value,n.value)}return{diffEditorRef:i}}var hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("MonacoEditor",{ref:"monaco",staticStyle:{height:"100%"},attrs:{options:e.options,language:e.lang,theme:e.theme==="dark"?"vs-dark":"vs"},on:{change:function(r){return e.input()}},model:{value:e.value,callback:function(r){e.value=r},expression:"value"}})},di=[];const pi={components:{MonacoEditor:ni},props:{content:{type:String,default:()=>null},draft:{type:String,default:()=>null},item:{type:Object,default:()=>null}},data(){var e;return{value:(e=this.draft)!=null?e:this.content,debounceTimer:null}},computed:{lang(){var e,t;return(t=(e=this.item)==null?void 0:e.language)!=null?t:this.item.mime.split("/").pop()},options(){var e,t;return(t=(e=this.item)==null?void 0:e.options)!=null?t:{}},theme(){var e,t;return(t=(e=this.$panel.theme)==null?void 0:e.current)!=null?t:""}},watch:{content(){var e;this.value=(e=this.draft)!=null?e:this.content},draft(e){e===null&&(this.value=this.content)}},created(){pe.config({paths:{vs:this.$panel.urls.site+"/media/plugins/plain/editor/vs"}})},methods:{input(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>this.$emit("update",this.value),500)}}},dt={};var fi=y(pi,hi,di,!1,gi,null,null,null);function gi(e){for(let t in dt)this[t]=dt[t]}var vi=function(){return fi.exports}(),mi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-dialog",e._b({ref:"dialog",attrs:{size:"large","submit-button":e.$t("plain.editor.notify.risk.submit")},on:{cancel:function(r){return e.$emit("cancel")},submit:function(r){return e.$emit("submit")}}},"k-dialog",e.$props,!1),[e._t("default",function(){return[n("div",{staticClass:"k-editor-notify-risk"},[n("k-icon",{attrs:{theme:"negative",type:"alert"}}),n("p",[e._v(e._s(e.$t("plain.editor.notify.risk.title")))]),n("i",[e._v(e._s(e.$t("plain.editor.notify.risk.desc")))])],1)]})],2)},wi=[],Ei="";const ki={extends:"k-dialog"},pt={};var bi=y(ki,mi,wi,!1,_i,null,null,null);function _i(e){for(let t in pt)this[t]=pt[t]}var xi=function(){return bi.exports}(),Hi="";window.panel.plugin("plain/editor",{components:{"k-editor-view":kt,"k-editor-header":St,"k-editor-preview":Tt,"k-editor-preview-default":Gt,"k-editor-preview-folder":tn,"k-editor-preview-font":on,"k-editor-preview-markdown":Xn,"k-editor-preview-object":nr,"k-editor-preview-text":vi,"k-file-tree":Dt,"k-editor-notify-risk":xi},dialog:{},fields:{filetree:At},icons:{"file-javascript":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M13.3344 16.055 12.4764 17.243C13.2904 17.969 14.3024 18.332 15.5124 18.332 16.4364 18.31 17.1404 18.0717 17.6244 17.617 18.1157 17.155 18.3614 16.605 18.3614 15.967 18.3614 15.3437 18.1891 14.8303 17.8444 14.427 17.4997 14.0237 16.9204 13.701 16.1064 13.459 15.4317 13.2537 14.9551 13.0667 14.6764 12.898 14.3977 12.722 14.2584 12.5093 14.2584 12.26 14.2584 12.0327 14.3721 11.8493 14.5994 11.71 14.8267 11.5707 15.1311 11.501 15.5124 11.501 15.7911 11.501 16.1064 11.556 16.4584 11.666 16.8104 11.7613 17.1221 11.9153 17.3934 12.128L18.1634 10.929C17.4887 10.3863 16.5941 10.115 15.4794 10.115 14.6801 10.115 14.0237 10.3203 13.5104 10.731 12.9824 11.1417 12.7184 11.6513 12.7184 12.26 12.7257 12.9053 12.9384 13.4077 13.3564 13.767 13.7817 14.1263 14.3867 14.4197 15.1714 14.647 15.8241 14.8523 16.2677 15.0577 16.5024 15.263 16.7297 15.4683 16.8434 15.7177 16.8434 16.011 16.8434 16.297 16.7297 16.517 16.5024 16.671 16.2677 16.8323 15.9304 16.913 15.4904 16.913 14.7717 16.9203 14.0531 16.6343 13.3344 16.055ZM7.80405 16.693C7.58405 16.561 7.37872 16.3667 7.18805 16.11L6.15405 16.957C6.46205 17.4777 6.84339 17.8407 7.29805 18.046 7.72339 18.2367 8.21105 18.332 8.76105 18.332 9.06172 18.332 9.37339 18.2843 9.69605 18.189 10.0187 18.0937 10.3157 17.9323 10.5871 17.705 11.0637 17.3237 11.3131 16.7003 11.3351 15.835V10.247H9.85005V15.549C9.85005 16.055 9.73639 16.4107 9.50905 16.616 9.28172 16.814 8.99572 16.913 8.65105 16.913 8.32105 16.913 8.03872 16.8397 7.80405 16.693ZM3 6C3 4.34315 4.34315 3 6 3H18C19.6569 3 21 4.34315 21 6V18C21 19.6569 19.6569 21 18 21H6C4.34315 21 3 19.6569 3 18V6ZM6 5C5.44772 5 5 5.44772 5 6V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V6C19 5.44772 18.5523 5 18 5H6Z"></path></svg>',"file-php":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10.15 5.5498L8.43273 14.3844H10.4327L11.2914 9.96713H12.7914C13.3437 9.96713 13.7059 10.4066 13.6006 10.9488L12.9327 14.3844H14.9327L15.6006 10.9488C15.9167 9.32234 14.8298 8.00387 13.173 8.00387H11.673L12.15 5.5498H10.15ZM2.17285 8.00392H5.92285C7.71777 8.00392 8.89521 9.43226 8.55272 11.1942C8.21023 12.9562 6.47751 14.3845 4.68259 14.3845H2.93259L2.45557 16.8386H0.455566L2.17285 8.00392ZM3.31421 12.4212H5.06421C5.75456 12.4212 6.42099 11.8719 6.55272 11.1942C6.68444 10.5165 6.23159 9.96717 5.54123 9.96717H3.79123L3.31421 12.4212ZM17.1728 8.00392H20.9228C22.7178 8.00392 23.8952 9.43226 23.5527 11.1942C23.2102 12.9562 21.4775 14.3845 19.6826 14.3845H17.9326L17.4556 16.8386H15.4556L17.1728 8.00392ZM18.3142 12.4212H20.0642C20.7546 12.4212 21.421 11.8719 21.5527 11.1942C21.6844 10.5165 21.2316 9.96717 20.5412 9.96717H18.7912L18.3142 12.4212Z"></path></svg>',"file-pdf":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 4H15V8H19V20H5V4ZM3.9985 2C3.44749 2 3 2.44405 3 2.9918V21.0082C3 21.5447 3.44476 22 3.9934 22H20.0066C20.5551 22 21 21.5489 21 20.9925L20.9997 7L16 2H3.9985ZM10.4999 7.5C10.4999 9.07749 10.0442 10.9373 9.27493 12.6534C8.50287 14.3757 7.46143 15.8502 6.37524 16.7191L7.55464 18.3321C10.4821 16.3804 13.7233 15.0421 16.8585 15.49L17.3162 13.5513C14.6435 12.6604 12.4999 9.98994 12.4999 7.5H10.4999ZM11.0999 13.4716C11.3673 12.8752 11.6042 12.2563 11.8037 11.6285C12.2753 12.3531 12.8553 13.0182 13.5101 13.5953C12.5283 13.7711 11.5665 14.0596 10.6352 14.4276C10.7999 14.1143 10.9551 13.7948 11.0999 13.4716Z"></path></svg>',"file-css":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2.8 14H4.83961L4.2947 16.7245L10.0393 18.8787L17.2665 16.4697L18.3604 11H3.4L3.8 9H18.7604L19.5604 5H4.6L5 3H22L19 18L10 21L2 18L2.8 14Z"></path></svg>',"file-vue":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3.31677 3L12.001 18L20.6852 3H23.001L12.001 22L1.00098 3H3.31677ZM7.65887 3L12.001 10.5L16.3431 3H18.6589L12.001 14.5L5.34308 3H7.65887Z"></path></svg>',"file-html":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 18.1778L7.38083 16.9222L7.0517 13.3778H9.32156L9.48045 15.2222L12 15.8889L14.5195 15.2222L14.7806 12.3556H6.96091L6.32535 5.67778H17.6747L17.4477 7.88889H8.82219L9.02648 10.1444H17.2434L16.6192 16.9222L12 18.1778ZM3 2H21L19.377 20L12 22L4.62295 20L3 2ZM5.18844 4L6.48986 18.4339L12 19.9278L17.5101 18.4339L18.8116 4H5.18844Z"></path></svg>',"file-add":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15 4H5V20H19V8H15V4ZM3 2.9918C3 2.44405 3.44749 2 3.9985 2H16L20.9997 7L21 20.9925C21 21.5489 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918ZM11 11V8H13V11H16V13H13V16H11V13H8V11H11Z"></path></svg>',"file-font":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6V21H8V6H2V4H16V6H10ZM18 14V21H16V14H13V12H21V14H18Z"></path></svg>',"folder-add":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.4142 5H21C21.5523 5 22 5.44772 22 6V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3H10.4142L12.4142 5ZM4 5V19H20V7H11.5858L9.58579 5H4ZM11 12V9H13V12H16V14H13V17H11V14H8V12H11Z"></path></svg>'}})})(Vue);
